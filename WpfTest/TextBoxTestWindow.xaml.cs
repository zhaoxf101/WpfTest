using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO.Packaging;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;

namespace WpfTest
{
    /// <summary>
    /// TextBoxTestWindow.xaml 的交互逻辑
    /// </summary>
    public partial class TextBoxTestWindow : Window
    {
        public TextBoxTestWindow()
        {
            InitializeComponent();

            //TxtContent.HtmlText = @"<P><SPAN STYLE=""font-size:14;"">应用早在《内经》中就已有了记载，如《灵枢》中有</SPAN></P>";
            //TxtContent.HtmlText = @"<P><SPAN STYLE=""font-size:14px;font-family:微软雅黑;"">应用早在《内经》中就已有了记载，如《灵枢》中有</SPAN></P><P STYLE=""text-indent:20px;""><SPAN STYLE=""font-size:14px;font-family:微软雅黑;"">&nbsp;</SPAN></P><P STYLE=""text-indent:20px;""><SPAN STYLE=""font-size:14px;font-family:微软雅黑;"">&nbsp;　</SPAN></P>";
            //TxtContent.HtmlText = @"<P><SPAN STYLE=""font-family:微软雅黑;font-size:14px;"">应用早在《内经》中就已有了记载，如《灵枢》中有</SPAN></P><P STYLE=""text-indent:20px;""><SPAN STYLE=""font-family:微软雅黑;font-size:14px;"">&nbsp;</SPAN></P><P STYLE=""text-indent:20px;""><SPAN STYLE=""font-family:微软雅黑;font-size:14px;"">&nbsp;　</SPAN><SPAN STYLE=""color:#000000;font-size:14px;font-family:微软雅黑;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetImage.Source&nbsp;=&nbsp;</SPAN><SPAN STYLE=""color:#0000FF;font-size:14px;font-family:微软雅黑;"">new</SPAN><SPAN STYLE=""color:#000000;font-size:14px;font-family:微软雅黑;"">&nbsp;BitmapImage(</SPAN><SPAN STYLE=""color:#0000FF;font-size:14px;font-family:微软雅黑;"">new</SPAN><SPAN STYLE=""color:#000000;font-size:14px;font-family:微软雅黑;"">&nbsp;Uri(url,&nbsp;UriKind.RelativeOrAbsolute));</SPAN></P><DIV STYLE=""text-align:Justify;""><IMG SRC=""http://img.xyunhui.com/Image1712181529177840c0.jpg"" TITLE="""" ALT="""" STYLE=""width:299;height:154px;"" /></DIV>";
            //TxtContent.HtmlText = @"<P><SPAN STYLE=""font-family:微软雅黑;font-size:14px;"">应用早在《内经》中就已有了记载，如《灵枢》中有</SPAN></P><P STYLE=""text-indent:20px;""><SPAN STYLE=""font-family:微软雅黑;font-size:14px;"">&nbsp;</SPAN></P><P STYLE=""text-indent:20px;""><SPAN STYLE=""font-family:微软雅黑;font-size:14px;"">&nbsp;　</SPAN><SPAN STYLE=""font-family:微软雅黑;font-size:14px;color:#000000;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetImage.Source&nbsp;=&nbsp;</SPAN><SPAN STYLE=""font-family:微软雅黑;font-size:14px;color:#0000FF;"">new</SPAN><SPAN STYLE=""font-family:微软雅黑;font-size:14px;color:#000000;"">&nbsp;</SPAN><SPAN STYLE=""font-family:Microsoft YaHei UI;font-size:12px;color:#000000;"">BitmapImage</SPAN><SPAN STYLE=""font-family:微软雅黑;font-size:14px;color:#000000;"">(</SPAN><SPAN STYLE=""font-family:微软雅黑;font-size:14px;color:#0000FF;"">new</SPAN><SPAN STYLE=""font-family:微软雅黑;font-size:14px;color:#000000;"">&nbsp;Uri(url,&nbsp;UriKind.RelativeOrAbsolute));</SPAN></P><DIV STYLE=""text-align:Justify;""><IMG SRC=""http://img.xyunhui.com/Image1712181545142181df.jpg"" TITLE="""" ALT="""" STYLE=""width:107;"" /></DIV>";

            TxtContent.DefaultFontFamily = "微软雅黑";
            TxtContent.DefaultFontSize = "24";

            TxtContent.HtmlText = @"<P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;星空媒体&nbsp;&nbsp;&nbsp;&nbsp;自助服务平台</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><IMG SRC=""http://img.xyunhui.com/Image1712182056349213ea.png"" TITLE="""" ALT="""" STYLE=""width:15px;height:15px;"" /><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;网站首页</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;媒体价格</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;专属顾问</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;400&nbsp;8399&nbsp;209</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zhaoxf101@qq.com&nbsp;</P><P STYLE=""margin:5px 0 5px 0;text-align:Center;font-family:微软雅黑;font-size:14px;""><IMG SRC=""http://img.xyunhui.com/Image1712182016333229c6.jpg"" TITLE="""" ALT="""" STYLE=""width:141px;height:92px;"" /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;我的帐户</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;我的专属客服&nbsp;&nbsp;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;我关注的媒体&nbsp;&nbsp;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;交易管理</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在线充值&nbsp;&nbsp;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易记录</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;发布管理</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;发布稿件&nbsp;&nbsp;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;发布记录</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;代写管理</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;代写稿件&nbsp;&nbsp;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;代写列表</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;发票管理</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;申请发票&nbsp;&nbsp;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;发票列表</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""text-align:Center;font-size:14px;font-family:微软雅黑;""><IMG SRC=""http://img.xyunhui.com/Image171218202404954b2e.jpg"" TITLE="""" ALT="""" STYLE=""width:134px;height:50px;"" /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">1.填写稿件&nbsp;|&nbsp;2.选择媒体&nbsp;|&nbsp;3.确认支付&nbsp;|&nbsp;4.媒体出稿</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">标题<IMG SRC=""http://img.xyunhui.com/Image1712182057074162ed.png"" TITLE="""" ALT="""" STYLE=""width:62px;height:62px;"" /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">剩余：44</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">上传稿件</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">选择文件&nbsp;可上传docx格式的文档,单张图片不能超5M</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">内容</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">arial</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">16px</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">×</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">本地保存成功</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">元素路径:&nbsp;body&nbsp;&gt;&nbsp;p&nbsp;&gt;&nbsp;br</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;&nbsp;&nbsp;&nbsp;当前已输入0个字符,&nbsp;您还可以输入50000个字符。</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">预览稿件&nbsp;下一步&nbsp;选择媒体</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&nbsp;填写稿件注意事项</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">1、文章标题：&nbsp;文章标题一般是18字，最长不超过25字，部分媒体编辑会修改；可嵌入关键词；尽量别写副标题！部分媒体加副标题会导致审核无法通过。</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">2、文章内容：&nbsp;文章不要太广告，尽量“软”一些，增强可读性；字数一般1200字左右为宜；由于各网站都有固定字体和格式，因此您在编辑框里的排版，比如修改字体大小、颜色、加粗等，都是无效的，仅供网站编辑参考而已！建议对整篇文章清空格式。内容均不得含声明维权、负面、违法、政治敏感内容！部分媒体会添加免责声明</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">3、关于图片：&nbsp;建议不超过3张（超过3张可能被编辑去除），宽度480像素居中，小于1M，图片默认可带（备注不可带图除外）；</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">4、关于网址、二维码、联系方式：默认不可带，备注可带的除外，部分媒体可带；</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">5、媒体选择：所选媒体可能会因为审稿不达标，导致个别所选媒体不能发布届时会退款，建议您更换媒体。</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">6、发布要求：“默认无要求[可适当修改后发布]”，如稿件有不符合要求的内容，编辑会进行修改，所以需要原稿发布禁止修改的请勿选择此项！请根据自己的要求，认真选择要求！</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">7、提交后修改内容：请在提交前仔细检查，一经提交您将不能修改！如果属于操作失误，可紧急联系客服人员处理，我们将尽量与网站编辑沟通协调。</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">8、审稿时间：工作日早上9点-下午6点左右，下午16点后提交的文章一般在隔天发布。</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">9、发布速度：一篇文章的发布时间为1-48小时以内，平均大约花费6小时。</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">10、内容注意事项：文章内容必须属于合法内容，如有负面、涉政、敏感等一律不予发布并停止账号使用。</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">合作媒体&nbsp;|&nbsp;联系我们&nbsp;|&nbsp;关于我们&nbsp;|&nbsp;招贤纳士&nbsp;|&nbsp;常见问题&nbsp;|&nbsp;意见反馈</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">字符&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;十进制&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;转义字符</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;#38;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&lt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;#60;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;#62;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;gt;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">不断开空格(non-breaking&nbsp;space)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;#160;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">CopyRight&nbsp;©&nbsp;2015-2016&nbsp;All&nbsp;Right&nbsp;Reserved.</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">星空媒体是国内领先的媒体服务平台，隶属于郑州璀璨网络科技有限公司旗下。&nbsp;&nbsp;豫ICP备15015831号-1</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">星空媒体提供上万个媒体的海量精准数据，涵盖网络新闻媒体、微信微博、视频、报纸杂志、贴吧论坛、问答百科等类型。</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;"">`</P><P STYLE=""margin:5px 0 5px 0;font-family:微软雅黑;font-size:14px;""><BR /></P>";

        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            
            var t = TxtContent.HtmlText;

            Debug.WriteLine(t);
            // pack://payload:,,wpf1,/Xaml/Document.xaml" UriSource ="./Image1.bmp


            // <FlowDocument PagePadding="5,0,5,0" AllowDrop="True" NumberSubstitution.CultureSource="User" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"><BlockUIContainer TextAlignment="Justify"><Image Width="400" Height="134"><Image.Source><BitmapImage BaseUri="pack://payload:,,wpf1,/Xaml/Document.xaml" UriSource="./Image1.bmp" CacheOption="OnLoad" /></Image.Source></Image></BlockUIContainer></FlowDocument>

            //TxtContent.HtmlText = @"<P><IMG SRC=""file:///D:/MyFiles/History/云合景从项目/切图/网站建设/产品维护（添加）.png"" TITLE="""" ALT="""" /></P>";

        }
    }
}
