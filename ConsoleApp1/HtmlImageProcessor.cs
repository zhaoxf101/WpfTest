using HtmlAgilityPack;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Xml;

namespace ConsoleApp1
{
    class HtmlImageProcessor
    {
        public static void Test()
        {
            //var html = @"<P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">平台：是电子商务的一种模式，是英文</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">Business-to-Business</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">的缩写，即商业对商业，或者说是企业间的电子商务，即企业与企业之间通过互联网进行产品、服务及信息的交换。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">收录：指搜索引擎把网站索引到自己的数据库中，用户可以通过搜索引擎提交入口提交网站吸引蜘蛛抓取页面，或通过外部链接吸引搜索引擎访问网站页面，当搜索引擎认为页面符合收录标准时，就会收录于网站页面。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">网站的作用就是用来推广产品和提高搜索引擎排名。但是两者的前提是必须要让人找到，这那就是搜索引擎需要收录你所发布的文章，那么就回归了本文要讲的重点：如何提高</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">平台收录和排名？</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">提高</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">平台收录和排名对中小企业有帮助</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;""><IMG SRC=""http://img.xyunhui.com/Image18041416305169510d.jpg"" TITLE="""" ALT="""" STYLE=""width:451px;height:221px;"" /></SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">一、平台的选择</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">选择好的平台的是你做</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">的重点一步。大部分情况下看网站权重</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">&nbsp;</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">网站权重越高，信息越容易被收录。可以通过站长工具或者爱站网查询，一般</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">2</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">以上，在一个月内收录量较大的为主。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">二、发布信息要选对类别</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">在所有</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">网站和分类信息网站上发布信息，都会要求选类别。类别一定要根据产品属性，选择合适或者相近（没有理想的就选相近的）的类别，如果类别选择错误，轻则减少用户看到该信息的几率，重则导致该信息被系统或者网站管理员删除。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">三、信息标题编写技巧</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">信息标题非常重要！信息标题在网页中，通常会被赋予</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">H1</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">标签，</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">H1</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">标签是搜索引擎识别该页面的重要参考因素。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">所以在信息标题编写中</SPAN><SPAN STYLE=""color:#444444;font-size:14px;font-family:微软雅黑;"">,</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">要注意这一点：相关度。搜索引擎对于内容的排名，第一参考因素就是相关度。因此，标题内容一定要与信息内容相关，且是整篇内容想要表达的核心。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">四、内容的编写技巧</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">段落清晰：一定要井井有条，为什么？发信息的最终目的就是让用户看，再转化成咨询、成交，试问一团乱麻的信息，谁会看呢？</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">关键词合理嵌入：一般笔者都会在首尾和文章中间总计插入</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">3-5</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">个关键词，并且适当加粗。这样的做的目的不仅是让搜索引擎认为你的文章相关度高，更能也能让用户知道你这篇文章的主要信息。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">图文结合：图文的好处一是提升页面美观度，减轻用户阅读压力；二是图片被搜索引擎收录之后，用户在搜索图片的时候也可以找到我们。并且可以在图片上加入我们联系方式，让用户更加快速的找到我们！</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">原创度：这个毋庸多讲，搜索引擎最喜欢原创的东西。所以一般要达到</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">70%</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">的原创度最佳！</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Justify;font-family:Times New Roman;font-size:14px;""><BR /></P>";
            var html = @"<P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">平台：是电子商务的一种模式，是英文</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">Business-to-Business</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">的缩写，即商业对商业，或者说是企业间的电子商务，即企业与企业之间通过互联网进行产品、服务及信息的交换。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">收录：指搜索引擎把网站索引到自己的数据库中，用户可以通过搜索引擎提交入口提交网站吸引蜘蛛抓取页面，或通过外部链接吸引搜索引擎访问网站页面，当搜索引擎认为页面符合收录标准时，就会收录于网站页面。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">网站的作用就是用来推广产品和提高搜索引擎排名。但是两者的前提是必须要让人找到，这那就是搜索引擎需要收录你所发布的文章，那么就回归了本文要讲的重点：如何提高</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">平台收录和排名？</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">提高</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">平台收录和排名对中小企业有帮助</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;""><table> <IMG SRC=""http://img.xyunhui.com/Image18041416305169510d.jpg"" TITLE="""" ALT="""" </table> <IMG SRC=""http://img.xyunhui.com/Image18041416305169510d.jpg"" TITLE="""" ALT="""" STYLE=""width:451px;height:221px;"" /></SPAN>   </P>  <P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">一、平台的选择</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">选择好的平台的是你做</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">的重点一步。大部分情况下看网站权重</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">&nbsp;</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">网站权重越高，信息越容易被收录。可以通过站长工具或者爱站网查询，一般</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">2</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">以上，在一个月内收录量较大的为主。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">二、发布信息要选对类别</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">在所有</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">b2b</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">网站和分类信息网站上发布信息，都会要求选类别。类别一定要根据产品属性，选择合适或者相近（没有理想的就选相近的）的类别，如果类别选择错误，轻则减少用户看到该信息的几率，重则导致该信息被系统或者网站管理员删除。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">三、信息标题编写技巧</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">信息标题非常重要！信息标题在网页中，通常会被赋予</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">H1</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">标签，</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">H1</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">标签是搜索引擎识别该页面的重要参考因素。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">所以在信息标题编写中</SPAN><SPAN STYLE=""color:#444444;font-size:14px;font-family:微软雅黑;"">,</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">要注意这一点：相关度。搜索引擎对于内容的排名，第一参考因素就是相关度。因此，标题内容一定要与信息内容相关，且是整篇内容想要表达的核心。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">四、内容的编写技巧</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">段落清晰：一定要井井有条，为什么？发信息的最终目的就是让用户看，再转化成咨询、成交，试问一团乱麻的信息，谁会看呢？</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">关键词合理嵌入：一般笔者都会在首尾和文章中间总计插入</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">3-5</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">个关键词，并且适当加粗。这样的做的目的不仅是让搜索引擎认为你的文章相关度高，更能也能让用户知道你这篇文章的主要信息。</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">图文结合：图文的好处一是提升页面美观度，减轻用户阅读压力；二是图片被搜索引擎收录之后，用户在搜索图片的时候也可以找到我们。并且可以在图片上加入我们联系方式，让用户更加快速的找到我们！</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Left;font-family:Times New Roman;font-size:14px;""><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">原创度：这个毋庸多讲，搜索引擎最喜欢原创的东西。所以一般要达到</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">70%</SPAN><SPAN STYLE=""font-family:宋体;color:#444444;font-size:14px;"">的原创度最佳！</SPAN></P><P STYLE=""margin:0 0 0 0;text-align:Justify;font-family:Times New Roman;font-size:14px;""><BR /></P>";
            var doc = new HtmlDocument();
            doc.LoadHtml(html);

            var nodes = doc.DocumentNode.Descendants("img")

    .ToList();

            foreach (var item in nodes)
            {
                item.Attributes["src"].Value = "http://l.b2b168.com/2018/04/14/16/20180414161613414384.jpg";

            }

            var str = "http://l.b2b168.com/2018/04/14/16/20180414161613414384.jpg";

            if (Uri.TryCreate(str, UriKind.Absolute, out Uri uri))
            {

            }


            doc.OptionOutputOptimizeAttributeValues = true;

            StringWriter sw = new StringWriter();

            XmlTextWriter xw = new XmlTextWriter(sw);

            doc.Save(sw);

            var st = sw.ToString();
        }
    }
}
